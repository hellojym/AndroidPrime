# HTTPS的加密原理

#### 在讲主题之前，我们先来区分两个概念：签名和加密有什么区别？

我们从字面意思看：

签名就是一个人对一个文件签署自己的名字，证明这个文件是我写的，别人认识我的字迹，所以只要别人看到我的签名，认识我字迹的人就知道这个文件确实是我写的。

加密就是将一段内容按照一定规则打乱，让不懂规则的人看不懂这段文字内容，而知道规则的人可以将乱序的内容反推出原文来，从而实现了内容在传递过程中不被不相关的人所理解，达到安全的目的。

为什么要讲这两个东西呢？因为这两个概念在HTTPS加密过程中是很重要的前提概念，不要混淆。



#### 接下来进入正题，HTTPS的加密原理

为了生动的讲述这个过程，我们利用一段角色故事来说明：

故事里有三个角色：分别是小红A，小强B，和小贱C.

小红A代表服务器，小强B代表客户端，小贱C代表中间劫持者。以下用ABC简称。



故事是这样的，小红和小强互相爱慕对方，但是二者离得有点远，所以只能通过扔纸条的方式把信息互相传递给对方。

而C特别好奇，就老想在中间把纸条拦截下来偷看，显然A和B是不愿意的，所以他们要想办法，既要实现二者的沟通，又要实现中间人截获了纸条也看不懂。

他们想到了以下几种方案：



1：

方法：A和B分别对信息用密钥x加密，然后互相传递信息后用x解密，这样C确实即使截获到了也看不懂了。

这里的方案就是对称加密方案，对称加密方案效率高，但是有个很大的缺陷：A和B怎么知道密钥x呢？第一次传递的时候明文传递给对方吗？显然不行，因为C可能也能截获到密钥x，这样c也能解密消息了。

  


因此要解决如何传递x密钥的问题

2:

方法：A想了一个高招，她研究出了一种绝技：她把纸条包装成一个神奇的盒子，这个盒子神奇在于：除了A本人外，其他人只能往里塞东西，却无法获取盒子里的内容。于是A这样操作：给B扔一个盒子，B拿到盒子以后，往里放一段随机生成的密钥，扔回了A。这个过程即是被C截获了，C也拿不到盒子内部的东西，所以是安全的。之后A从盒子里把B给他的密钥拿出来，然后他们就用这段密钥通过方法1的方式沟通了。

  


该方法就是现在Https的建立方法，利用的非对称加密+对称加密的方式。

其中黑盒子就是非对称加密的公钥，往盒子里扔东西就是用这段公钥对信息加密的过程，之后带有信息的黑盒子只有利用私钥才能解开。

  


其实还有一种方案3:

3：

即A和B都有黑盒子，他们互相吧自己的黑盒子扔个对方，然后彼此把消息放到黑盒子里，扔回去，这样其实也能实现安全沟通，但是有个很大的缺点，就是每条信息两个人都要向黑盒子里塞东西，这个过程太麻烦了，效率很低，所以该方案也不太好。

这里往黑盒子里塞东西就是非对称加密的缺点，计算量大，使得效率降低，因此https也没有采用这个方案

